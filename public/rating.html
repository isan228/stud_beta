<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#2563eb">
    <title>–†–µ–π—Ç–∏–Ω–≥ - stud.kg</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .rating-page { max-width: 900px; margin: 0 auto; padding: 2rem 1rem; }
        .rating-table { width: 100%; border-collapse: collapse; background: var(--card-bg); border-radius: 12px; overflow: hidden; box-shadow: 0 2px 12px rgba(0,0,0,0.08); }
        .rating-table th, .rating-table td { padding: 0.875rem 1rem; text-align: left; border-bottom: 1px solid var(--border-color); }
        .rating-table th { background: var(--bg-secondary); font-weight: 600; color: var(--text-primary); }
        .rating-table tr:last-child td { border-bottom: none; }
        .rating-table tr:hover td { background: var(--bg-secondary); }
        .rating-rank { font-weight: 700; color: var(--primary-color); min-width: 2.5rem; }
        .rating-rank.top1 { color: #f59e0b; }
        .rating-rank.top2 { color: #94a3b8; }
        .rating-rank.top3 { color: #b45309; }
        .rating-loading, .rating-empty { text-align: center; padding: 3rem; color: var(--text-secondary); }
        .rating-empty { font-size: 1.1rem; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand"><a href="/"><h1>stud.kg</h1></a></div>
            <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="–ú–µ–Ω—é"><span></span><span></span><span></span></button>
            <div class="nav-menu" id="navMenu">
                <a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/tests" class="nav-link">–¢–µ—Å—Ç—ã</a>
                <a href="/rating" class="nav-link active">–†–µ–π—Ç–∏–Ω–≥</a>
                <a href="/news" class="nav-link">–ù–æ–≤–æ—Å—Ç–∏</a>
                <a href="/about" class="nav-link">–û –Ω–∞—Å</a>
                <a href="/favorites" class="nav-link" id="favoritesLink" style="display: none;">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
                <a href="/profile" class="nav-link" id="profileLink" style="display: none;">–ü—Ä–æ—Ñ–∏–ª—å</a>
                <a href="/contact" class="nav-link">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</a>
                <div class="nav-actions">
                    <button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"><span class="theme-icon">üåô</span></button>
                    <a href="/login" class="btn btn-primary" id="loginBtn">–í–æ–π—Ç–∏</a>
                    <a href="/register" class="btn btn-secondary" id="registerBtn">–ü–æ–¥–ø–∏—Å–∫–∞</a>
                    <button class="btn btn-logout" id="logoutBtn" style="display: none;">–í—ã—Ö–æ–¥</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <div class="rating-page">
            <div class="page-header" style="text-align: center; margin-bottom: 2rem;">
                <h1>–†–µ–π—Ç–∏–Ω–≥</h1>
                <p class="page-description">–ö—Ç–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–¥–∞—ë—Ç —Ç–µ—Å—Ç—ã ‚Äî –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</p>
            </div>
            <div id="ratingContent">
                <div class="rating-loading" id="ratingLoading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞...</div>
                <div id="ratingTableWrap" style="display: none;"></div>
                <div class="rating-empty" id="ratingEmpty" style="display: none;">–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞. –ü—Ä–æ—Ö–æ–¥–∏—Ç–µ —Ç–µ—Å—Ç—ã!</div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2026 stud.kg. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <script src="app.js"></script>
    <script>
        (function() {
            initTheme();
            var loadingEl = document.getElementById('ratingLoading');
            var tableWrap = document.getElementById('ratingTableWrap');
            var emptyEl = document.getElementById('ratingEmpty');

            fetch('/api/leaderboard?limit=100')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    loadingEl.style.display = 'none';
                    var list = data.leaderboard || [];
                    if (list.length === 0) {
                        emptyEl.style.display = 'block';
                        return;
                    }
                    var html = '<table class="rating-table"><thead><tr><th>–ú–µ—Å—Ç–æ</th><th>–ù–∏–∫–Ω–µ–π–º</th><th>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</th><th>–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤</th><th>–¢–µ—Å—Ç–æ–≤</th><th>–¢–æ—á–Ω–æ—Å—Ç—å %</th></tr></thead><tbody>';
                    list.forEach(function(row) {
                        var rankClass = row.rank === 1 ? ' top1' : (row.rank === 2 ? ' top2' : (row.rank === 3 ? ' top3' : ''));
                        html += '<tr><td class="rating-rank' + rankClass + '">' + row.rank + '</td><td>' + (row.username || '‚Äî') + '</td><td>' + row.correctAnswers + '</td><td>' + row.totalQuestionsAnswered + '</td><td>' + row.totalTestsCompleted + '</td><td>' + row.accuracy + '%</td></tr>';
                    });
                    html += '</tbody></table>';
                    tableWrap.innerHTML = html;
                    tableWrap.style.display = 'block';
                })
                .catch(function() {
                    loadingEl.style.display = 'none';
                    emptyEl.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
                    emptyEl.style.display = 'block';
                });
        })();
    </script>
</body>
</html>
