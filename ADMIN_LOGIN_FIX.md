# Исправление проблемы входа в админку

## Проблема
Не удается войти в админку, хотя администратор создан.

## Решение

### 1. Проверьте данные для входа

В базе данных найден администратор:
- **Username:** `admin`
- **Email:** `admin@stud.kg`

**Используйте правильные данные:**
- Username: `admin` (не `username`)
- Password: пароль, который вы указали при создании (по умолчанию `admin123`)

### 2. Исправьте JWT_SECRET

Текущий JWT_SECRET установлен на значение по умолчанию `your_jwt_secret_key_here`. Это небезопасно и может вызывать проблемы.

**Исправление:**

```bash
# Сгенерируйте новый секретный ключ
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

# Откройте .env файл
nano .env

# Замените строку:
# JWT_SECRET=your_jwt_secret_key_here
# На:
# JWT_SECRET=сгенерированный_ключ_выше
```

Или используйте скрипт:
```bash
npm run fix-admin
```

### 3. Пересоздайте администратора (если забыли пароль)

```bash
# Удалите старого (опционально, через psql)
# Или просто создайте нового с другим именем
npm run create-admin новый_username новый_email новый_пароль
```

### 4. Перезапустите сервер

```bash
pm2 restart stud-kg
```

### 5. Проверьте логи

```bash
pm2 logs stud-kg --lines 50
```

При попытке входа вы должны увидеть:
- "Попытка входа администратора: { username: 'admin', passwordLength: ... }"
- "Администратор найден: { id: 1, username: 'admin' }"
- "Проверка пароля: true"

## Быстрая проверка

```bash
# Проверьте конфигурацию и администраторов
npm run fix-admin

# Протестируйте вход
npm run test-admin admin ваш_пароль
```

## Важно

1. **JWT_SECRET должен быть уникальным и длинным** (минимум 32 символа)
2. **Используйте правильное имя пользователя** - в вашем случае это `admin`, а не `username`
3. **Пароль чувствителен к регистру** - убедитесь, что вводите его правильно
4. **После изменения .env перезапустите сервер**

